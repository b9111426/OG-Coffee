"use strict";(self["webpackChunkog_coffee"]=self["webpackChunkog_coffee"]||[]).push([[963],{1085:function(t,e,a){a.d(e,{Z:function(){return w}});var l=a(6252),s=a(3577);const r={id:"delProductModal",ref:"modal",class:"modal scale-in-center",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},n={class:"modal-dialog modal-dialog-centered"},d={class:"modal-content border-0"},i={class:"modal-header bg-danger text-white"},o={id:"delProductModalLabel",class:"modal-title"},c={class:"modal-body"},p={class:"text-danger"},u={class:"modal-footer"},b=(0,l._)("button",{type:"button",class:"btn btn-outline-primary","data-bs-dismiss":"modal"}," 取消 ",-1);function _(t,e,a,_,g,h){return(0,l.wg)(),(0,l.iD)("div",r,[(0,l._)("div",n,[(0,l._)("div",d,[(0,l._)("div",i,[(0,l._)("h5",o,[(0,l._)("span",null,"刪除"+(0,s.zw)(a.title),1)]),(0,l._)("button",{type:"button",class:"btn-close bg-gray me-1","data-bs-dismiss":"modal","aria-label":"Close",onClick:e[0]||(e[0]=(...e)=>t.handClass&&t.handClass(...e))})]),(0,l._)("div",c,[(0,l.Uk)(" 是否刪除 "),(0,l._)("strong",p,(0,s.zw)(a.item.title),1),(0,l.Uk)(" "+(0,s.zw)(a.title)+"(刪除後將無法恢復)。 ",1)]),(0,l._)("div",u,[b,(0,l._)("button",{type:"button",class:"btn btn-danger",onClick:e[1]||(e[1]=e=>t.$emit("del-item",this.item.title))}," 確認刪除 ")])])])],512)}var g=a(1339),h={props:{item:Object,title:String},mixins:[g.Z],emits:["del-item"]},m=a(3744);const y=(0,m.Z)(h,[["render",_]]);var w=y},9103:function(t,e,a){a.d(e,{Z:function(){return y}});var l=a(6252),s=a(9963),r=a(3577);const n={"aria-label":"Page navigation example"},d={class:"pagination justify-content-center align-items-center"},i=["disabled"],o=["onClick"],c={key:0,class:"page-item disabled mx-1"},p=(0,l._)("a",{href:"#",class:"bg-gray text-white page-link rounded-1"},"1",-1),u=[p],b=["disabled"];function _(t,e,a,p,_,g){return(0,l.wg)(),(0,l.iD)("nav",n,[(0,l._)("ul",d,[(0,l._)("li",null,[(0,l._)("button",{type:"button",class:"btn text-primary bg-transparent border-0",disabled:!a.pages.has_pre,onClick:e[0]||(e[0]=(0,s.iM)((t=>g.updatePage(a.pages.current_page-1)),["prevent"]))},[(0,l._)("i",{class:(0,r.C_)(["bi bi-chevron-double-left fs-5",{"text-white opacity-75":!a.pages.has_pre}])},null,2)],8,i)]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(g.pageAry,(t=>((0,l.wg)(),(0,l.iD)("li",{class:(0,r.C_)(["page-item mx-1",{active:t===a.pages.current_page}]),key:t+"452"},[(0,l._)("a",{class:"page-link rounded-1",href:"#",onClick:(0,s.iM)((e=>g.updatePage(t)),["prevent"])},(0,r.zw)(t),9,o)],2)))),128)),a.pages.current_page?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("li",c,u)),(0,l._)("li",null,[(0,l._)("button",{type:"button",class:"btn text-primary bg-transparent border-0",disabled:!a.pages.has_next,onClick:e[1]||(e[1]=(0,s.iM)((t=>g.updatePage(a.pages.current_page+1)),["prevent"]))},[(0,l._)("i",{class:(0,r.C_)(["bi bi-chevron-double-right fs-5",{"text-white opacity-75":!a.pages.has_next}])},null,2)],8,b)])])])}a(7658);var g={props:["pages"],methods:{updatePage(t){"search"===this.pages.category?this.$emit("searchPages",t):this.$emit("emitPages",t,this.pages.category)}},computed:{pageAry(){const t=Math.abs(9*(Math.ceil(this.pages.current_page/9)-1)+1),e=[];for(let a=t;a<this.pages.total_pages+1;a++)e.push(a);return e}}},h=a(3744);const m=(0,h.Z)(g,[["render",_]]);var y=m},1804:function(t,e,a){a.r(e),a.d(e,{default:function(){return At}});var l=a(6252),s=a(3577),r=a(9963),n=a(7923);const d={class:"container py-3"},i=(0,l._)("h2",null,"後台訂單",-1),o={class:"row mt-4"},c={class:"col-12 d-flex align-items-center mb-2 mb-lg-0"},p={class:"bg-white p-2 rounded text-dark"},u={key:0,class:"ms-auto"},b=(0,l._)("img",{class:"loading",src:n,alt:""},null,-1),_=[b],g={class:"col-12"},h={class:"card overflow-auto flex-nowrap mt-2 px-3"},m={class:"table mt-4 table-hover"},y=(0,l._)("thead",null,[(0,l._)("tr",{class:"table-light"},[(0,l._)("th",{class:"text-nowrap"},"下單日期"),(0,l._)("th",{class:"text-nowrap"},"用餐選項"),(0,l._)("th",{class:"text-nowrap"},"購買款項"),(0,l._)("th",{class:"text-nowrap"},"應付金額"),(0,l._)("th",{class:"text-nowrap d-none d-lg-table-cell"},"是否付款"),(0,l._)("th",{class:"text-nowrap"},"編輯")])],-1),w={class:"list-unstyled"},f={class:"text-right"},v={class:"d-none d-lg-table-cell"},O={class:"d-flex justify-content-center"},k={class:"form-check"},x=["id","onUpdate:modelValue","onChange"],D=["for"],M={key:0,class:"text-primary text-nowrap"},$={key:1,class:"text-gray-dark text-nowrap"},C={class:"btn-group"},P=["onClick"],z=(0,l._)("span",{class:"d-lg-block d-none text-nowrap"},"編輯",-1),L=(0,l._)("i",{class:"bi bi-pencil-square d-lg-none"},null,-1),T=[z,L],Z=["onClick"],N=(0,l._)("span",{class:"d-lg-block d-none text-nowrap"},"刪除",-1),U=(0,l._)("i",{class:"bi bi-x-lg d-lg-none"},null,-1),q=[N,U],j={key:0,class:"text-center"},A=(0,l._)("td",{colspan:"6",class:"fs-3 text-gray py-4"},"訂單列表已空",-1),E=[A];function H(t,e,a,n,b,z){const L=(0,l.up)("OrderModal"),N=(0,l.up)("DelModal"),U=(0,l.up)("Pagination"),A=(0,l.Q2)("date");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",d,[i,(0,l._)("div",o,[(0,l._)("div",c,[(0,l._)("div",p,[(0,l._)("strong",null," 訂單總數: "+(0,s.zw)(z.allOrdersNum),1)]),b.isLoading?((0,l.wg)(),(0,l.iD)("div",u,_)):(0,l.kq)("",!0)]),(0,l._)("div",g,[(0,l._)("div",h,[(0,l._)("table",m,[y,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(z.orders,((t,e)=>((0,l.wg)(),(0,l.iD)("tr",{key:e,class:(0,s.C_)({"text-secondary":!t.is_paid})},[(0,l._)("td",null,[(0,l.wy)((0,l._)("span",null,null,512),[[A,t.create_at]])]),(0,l._)("td",null,[(0,l._)("span",null,(0,s.zw)(z.diningOption(t)),1)]),(0,l._)("td",null,[(0,l._)("ul",w,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.products,((t,e)=>((0,l.wg)(),(0,l.iD)("li",{class:"text-nowrap",key:e},(0,s.zw)(t.product.title)+" 數量："+(0,s.zw)(t.qty)+" "+(0,s.zw)(t.product.unit),1)))),128))])]),(0,l._)("td",f,(0,s.zw)(t.total),1),(0,l._)("td",v,[(0,l._)("div",O,[(0,l._)("div",k,[(0,l.wy)((0,l._)("input",{class:"form-check-input me-2",type:"checkbox",id:`paidSwitch${t.id}`,"onUpdate:modelValue":e=>t.is_paid=e,onChange:e=>z.updatePaid(t)},null,40,x),[[r.e8,t.is_paid]]),(0,l._)("label",{class:"form-check-label",for:`paidSwitch${t.id}`},[t.is_paid?((0,l.wg)(),(0,l.iD)("span",M,"已付款")):((0,l.wg)(),(0,l.iD)("span",$,"未付款"))],8,D)])])]),(0,l._)("td",null,[(0,l._)("div",C,[(0,l._)("button",{class:"btn btn-primary btn-sm",type:"button",onClick:e=>z.openModal(t)},T,8,P),(0,l._)("button",{class:"btn btn-danger btn-sm",type:"button",onClick:e=>z.openDelOrderModal(t)},q,8,Z)])])],2)))),128))]),0===z.orders.length?((0,l.wg)(),(0,l.iD)("tbody",j,E)):(0,l.kq)("",!0)])])])])]),(0,l.Wm)(L,{order:b.tempOrder,ref:"orderModal",onUpdatePaid:z.updatePaid},null,8,["order","onUpdatePaid"]),(0,l.Wm)(N,{item:b.tempOrder,title:b.title,ref:"delModal",onDelItem:z.delOrder},null,8,["item","title","onDelItem"]),(0,l.Wm)(U,{pages:z.pagination,onEmitPages:z.getOrders,class:"mt-3 pb-5"},null,8,["pages","onEmitPages"])],64)}var Y=a(1085),K=a(9103);const Q={class:"modal slide-in-fwd-center",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},S={class:"modal-dialog modal-dialog-centered modal-xl",role:"document"},V={class:"modal-content border-0"},W=(0,l._)("div",{class:"modal-header bg-dark text-white"},[(0,l._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,l._)("span",null,"訂單細節")]),(0,l._)("button",{type:"button",class:"btn-close bg-gray me-1","data-bs-dismiss":"modal","aria-label":"Close"})],-1),I={class:"modal-body"},R={class:"container"},B=(0,l._)("ul",{class:"nav nav-tabs",id:"myTab",role:"tablist"},[(0,l._)("li",{class:"nav-item",role:"presentation"},[(0,l._)("button",{class:"nav-link active",id:"home-tab","data-bs-toggle":"tab","data-bs-target":"#home",type:"button",role:"tab"}," 用戶外送資料 ")]),(0,l._)("li",{class:"nav-item",role:"presentation"},[(0,l._)("button",{class:"nav-link",id:"profile-tab","data-bs-toggle":"tab","data-bs-target":"#profile",type:"button",role:"tab","aria-controls":"profile","aria-selected":"false"}," 訂單細節 ")]),(0,l._)("li",{class:"nav-item",role:"presentation"},[(0,l._)("button",{class:"nav-link",id:"contact-tab","data-bs-toggle":"tab","data-bs-target":"#contact",type:"button",role:"tab","aria-controls":"contact","aria-selected":"false"}," 選購商品 ")])],-1),F={class:"tab-content",id:"myTabContent"},G={class:"tab-pane fade show active",id:"home",role:"tabpanel","aria-labelledby":"home-tab"},J={key:0,class:"table"},X=(0,l._)("th",{style:{width:"100px"}},"姓名",-1),tt=(0,l._)("th",null,"Email",-1),et=(0,l._)("th",null,"電話",-1),at=(0,l._)("th",null,"地址",-1),lt={key:1,class:"mt-4"},st={class:"tab-pane fade",id:"profile",role:"tabpanel","aria-labelledby":"profile-tab"},rt={class:"table"},nt=(0,l._)("th",{style:{width:"100px"}},"訂單編號",-1),dt=(0,l._)("th",null,"下單日期",-1),it=(0,l._)("th",null,"付款時間",-1),ot={key:0},ct={key:1},pt=(0,l._)("th",null,"付款狀態",-1),ut={key:0,class:"text-success"},bt={key:1,class:"text-muted"},_t=(0,l._)("th",null,"總金額",-1),gt=(0,l._)("span",{class:"h6"},"NT$ ",-1),ht={class:"tab-pane fade",id:"contact",role:"tabpanel","aria-labelledby":"contact-tab"},mt={class:"table"},yt=(0,l._)("thead",null,[(0,l._)("tr")],-1),wt={class:"text-end"},ft=(0,l._)("span",{class:"h6"},"NT$ ",-1),vt={class:"d-flex justify-content-end"},Ot={class:"form-check"},kt={class:"form-check-label",for:"flexCheckDefault"},xt={key:0},Dt={key:1},Mt={class:"modal-footer"},$t=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Ct(t,e,a,n,d,i){const o=(0,l.Q2)("date"),c=(0,l.Q2)("num");return(0,l.wg)(),(0,l.iD)("div",Q,[(0,l._)("div",S,[(0,l._)("div",V,[W,(0,l._)("div",I,[(0,l._)("div",R,[B,(0,l._)("div",F,[(0,l._)("div",G,[d.tempOrder.user?.isTogo?((0,l.wg)(),(0,l.iD)("table",J,[(0,l._)("tbody",null,[(0,l._)("tr",null,[X,(0,l._)("td",null,(0,s.zw)(d.tempOrder.user.name),1)]),(0,l._)("tr",null,[tt,(0,l._)("td",null,(0,s.zw)(d.tempOrder.user.email),1)]),(0,l._)("tr",null,[et,(0,l._)("td",null,(0,s.zw)(d.tempOrder.user.tel),1)]),(0,l._)("tr",null,[at,(0,l._)("td",null,(0,s.zw)(d.tempOrder.user.address),1)])])])):((0,l.wg)(),(0,l.iD)("p",lt,"此訂單為內用"))]),(0,l._)("div",st,[(0,l._)("table",rt,[(0,l._)("tbody",null,[(0,l._)("tr",null,[nt,(0,l._)("td",null,(0,s.zw)(d.tempOrder.id),1)]),(0,l._)("tr",null,[dt,(0,l._)("td",null,[(0,l.wy)((0,l._)("span",null,null,512),[[o,d.tempOrder.create_at]])])]),(0,l._)("tr",null,[it,(0,l._)("td",null,[d.tempOrder.paid_date?(0,l.wy)(((0,l.wg)(),(0,l.iD)("span",ot,null,512)),[[o,d.tempOrder.paid_date]]):((0,l.wg)(),(0,l.iD)("span",ct,"尚未付款"))])]),(0,l._)("tr",null,[pt,(0,l._)("td",null,[d.tempOrder.is_paid?((0,l.wg)(),(0,l.iD)("strong",ut,"已付款")):((0,l.wg)(),(0,l.iD)("span",bt,"尚未付款"))])]),(0,l._)("tr",null,[_t,(0,l._)("td",null,[gt,(0,l.wy)((0,l._)("span",null,null,512),[[c,d.tempOrder.total]])])])])])]),(0,l._)("div",ht,[(0,l._)("table",mt,[yt,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.tempOrder.products,(t=>((0,l.wg)(),(0,l.iD)("tr",{class:"text-start",key:t.id},[(0,l._)("th",null,(0,s.zw)(t.product.title),1),(0,l._)("td",null,(0,s.zw)(t.qty)+" / "+(0,s.zw)(t.product.unit),1),(0,l._)("td",wt,[ft,(0,l.wy)((0,l._)("span",null,null,512),[[c,t.final_total]])])])))),128))])])])]),(0,l._)("div",vt,[(0,l._)("div",Ot,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault","onUpdate:modelValue":e[0]||(e[0]=t=>d.tempOrder.is_paid=t)},null,512),[[r.e8,d.tempOrder.is_paid]]),(0,l._)("label",kt,[d.tempOrder.is_paid?((0,l.wg)(),(0,l.iD)("span",xt,"已付款")):((0,l.wg)(),(0,l.iD)("span",Dt,"未付款"))])])])])]),(0,l._)("div",Mt,[$t,(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=e=>t.$emit("update-paid",d.tempOrder))}," 修改付款狀態 ")])])])],512)}var Pt=a(1339),zt={props:{order:{type:Object,default(){return{}}}},data(){return{tempOrder:{}}},emits:["update-paid"],mixins:[Pt.Z],watch:{order(){this.tempOrder=this.order}}},Lt=a(3744);const Tt=(0,Lt.Z)(zt,[["render",Ct]]);var Zt=Tt,Nt=a(6486),Ut=a.n(Nt),qt={data(){return{tempOrder:{},currentPage:1,isLoading:!1,title:"訂單"}},components:{Pagination:K.Z,DelModal:Y.Z,OrderModal:Zt},methods:{async getOrders(t=1){this.currentPage=t;try{await this.$store.dispatch("Orders/getOrders",t),this.getAllOrders(),this.$store.dispatch("handLoading",!1)}catch(e){throw new Error(e)}},async getAllOrders(){try{await this.$store.dispatch("Orders/getAllOrders")}catch(t){throw new Error(t)}},openModal(t){this.tempOrder={...t};const e=this.$refs.orderModal;e.openModal()},openDelOrderModal(t){this.tempOrder={...t};const e=this.$refs.delModal;e.openModal()},updatePaid:Ut().debounce((async function(t){this.isLoading=!0;const e={id:t.id,order:t};try{let a=null;t.is_paid?a=await this.$store.dispatch("Orders/payOrder",t.id):(t.paid_date="",a=await this.$store.dispatch("Orders/modifyOrder",e)),this.isLoading=!1,await this.getOrders(this.currentPage);const l=this.$refs.orderModal;l.hideModal(),this.$store.dispatch("fireToast",{res:a})}catch(a){this.$store.dispatch("fireToast",{res:a.response})}}),1e3),delOrder:Ut().debounce((async function(){try{await this.$store.dispatch("Orders/deleteOrder",this.tempOrder.id);const t=this.$refs.delModal;t.hideModal(),this.getOrders(this.currentPage),this.$store.dispatch("fireToast",{title:"訂單已刪除",style:"success"})}catch(t){this.$store.dispatch("fireToast",{res:t.response})}}),500),diningOption(t){return t.user.isTogo?"外帶":t.user.isReserve?"預約外帶":"內用"}},created(){this.getOrders(),this.$store.dispatch("handLoading",!0)},computed:{orders(){return this.$store.getters["Orders/ordersData"]},pagination(){return this.$store.getters["Orders/ordersPage"]},paidNum(){return this.$store.getters["Orders/paidNum"]},allOrdersNum(){return this.$store.getters["Orders/allOrdersNum"]}}};const jt=(0,Lt.Z)(qt,[["render",H]]);var At=jt},7923:function(t,e,a){t.exports=a.p+"img/load.c8fc3381.gif"}}]);
//# sourceMappingURL=963.4e8e9ba1.js.map